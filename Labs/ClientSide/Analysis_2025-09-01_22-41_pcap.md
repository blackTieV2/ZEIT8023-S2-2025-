# ZEIT8023-S2-2025-
This is detailed investigaion of a  **truthful SPAN capture** (`redteam_ap_capture_2025-09-01_22-41.pcap`). It assumes the flow of a wireless forensics analysts: structured, layered, and always pivoting via filters.  

Below is a **step‚Äëby‚Äëstep workflow with commands, Wireshark/tshark filters.**  

---

# üß≠ Step 1 ‚Äî Baseline Recon of the Capture
**who‚Äôs talking** and **protocol mix**.

### Protocol Hierarchy
In Wireshark:  
```
Statistics ‚Üí Protocol Hierarchy
```
CLI equivalent:
```bash
tshark -r redteam_ap_capture_2025-09-01_22-41.pcap -q -z io,phs
```

#### Results

===================================================================
Protocol Hierarchy Statistics
Filter:

eth                                      frames:16792 bytes:3188291
  arp                                    frames:818 bytes:46434
  lldp                                   frames:67 bytes:15209
  llc                                    frames:346 bytes:25479
    stp                                  frames:333 bytes:19980
    cdp                                  frames:13 bytes:5499
  loop                                   frames:66 bytes:3960
    data                                 frames:66 bytes:3960
  ip                                     frames:15480 bytes:3092373
    udp                                  frames:3633 bytes:997780
      data                               frames:23 bytes:7770
      quic                               frames:3599 bytes:985714
        quic                             frames:54 bytes:32489
          quic                           frames:1 bytes:1292
      mdns                               frames:11 bytes:4296
    tcp                                  frames:11722 bytes:2084751
      tls                                frames:1910 bytes:1207447
        tcp.segments                     frames:247 bytes:330341
          tls                            frames:135 bytes:236201
      http                               frames:20 bytes:3737
      ssh                                frames:3 bytes:761
      mqtt                               frames:4 bytes:486
    igmp                                 frames:2 bytes:120
    icmp                                 frames:123 bytes:9722
  ipv6                                   frames:15 bytes:4836
    icmpv6                               frames:4 bytes:320
    udp                                  frames:11 bytes:4516
      mdns                               frames:11 bytes:4516
===================================================================


‚û°Ô∏è Show ratio of ARP, DNS, TLS, QUIC, etc.  

### Top Talkers
```bash
tshark -r redteam_ap_capture_2025-09-01_22-41.pcap -q -z endpoints,ip
```
‚û°Ô∏è Gives total packets/bytes per IP. This identifies the Android device (`192.168.80.8`).  

---

# üß≠ Step 2 ‚Äî Focus on *Your Phone‚Äôs Traffic*
Filter only your Android‚Äôs IP:
```wireshark
ip.addr == 192.168.80.8
```

Check conversations:
```bash
tshark -r redteam_ap_capture_2025-09-01_22-41.pcap -Y "ip.addr==192.168.80.8" -q -z conv,tcp
tshark -r redteam_ap_capture_2025-09-01_22-41.pcap -Y "ip.addr==192.168.80.8" -q -z conv,udp
```
‚û°Ô∏è Shows who the phone connects to, and over what ports.  

---

# üß≠ Step 3 ‚Äî DNS Analysis (Domain Attribution)
Your tcpdump already showed `allawnos.com`, `google.us`, and Google metrics. DNS is the **gold mine** for app attribution.

Wireshark display filter:
```wireshark
dns
```

Extract queried domains:
```bash
tshark -r redteam_ap_capture_2025-09-01_22-41.pcap -Y dns -T fields -e frame.time -e ip.src -e dns.qry.name | sort | uniq -c | sort -nr | head -20
```
‚û°Ô∏è Top 20 domains requested by your phone.  

Specific domains:
```wireshark
dns.qry.name contains "whatsapp"
dns.qry.name contains "gvt2"
dns.qry.name contains "google"
dns.qry.name contains "facebook"
```

---

# üß≠ Step 4 ‚Äî TLS/QUIC App Traffic Attribution
Since most traffic is encrypted, **TLS handshakes (SNI extension)** and QUIC `Server Name Indication` give you the domain names.

Filters:
```wireshark
tls.handshake.extensions_server_name
quic
```

CLI extraction of SNI:
```bash
tshark -r redteam_ap_capture_2025-09-01_22-41.pcap -Y 'tls.handshake.extensions_server_name' -T fields -e tls.handshake.extensions_server_name | sort | uniq -c | sort -nr | head -20
```

Common SNI hits = Google, WhatsApp, FB, telemetry, ad‚Äënetworks.  

---

# üß≠ Step 5 ‚Äî App Attribution Matrix
You can pivot domains ‚Üí apps:

- **WhatsApp** ‚Üí `e2.whatsapp.net`, `fbcdn.net`, `facebook.com`.  
- **Google Core/Telemetry** ‚Üí `gvt2.com`, `gstatic.com`, `1e100.net`.  
- **Ad & tracking** ‚Üí `allawnos.com`, `doubleclick.net`, `adjust.com`.  
- **Others**: PlayStore (`play.googleapis.com`), push services (`mtalk.google.com`).  

---

# üß≠ Step 6 ‚Äî Behavior Analysis
Look at **temporal patterns**: idle apps vs background chatter.

Wireshark:  
```
Statistics ‚Üí IO Graph
```
CLI:
```bash
tshark -r redteam_ap_capture_2025-09-01_22-41.pcap -q -z io,stat,60,"COUNT(ip.src==192.168.80.8)dns","COUNT(ip.src==192.168.80.8)tls"
```
‚û°Ô∏è Show DNS vs TLS connections per minute.  

---

# üß≠ Step 7 ‚Äî Suspicious Indicators
Search for:
```wireshark
dns.qry.name matches ".*\.ru"
dns.qry.name contains "allawnos.com"
http
```
- Unexpected geo‚Äëdomains?  
- Cleartext HTTP (rare today)?  
- Odd TLDs?  

---

# üîß Summary of Key Filters (copy‚Äëpaste ready)

- Only phone:
  ```
  ip.addr == 192.168.80.8
  ```
- DNS queries:
  ```
  dns
  ```
- WhatsApp:
  ```
  dns.qry.name contains "whatsapp"
  ```
- TLS SNI extraction:
  ```
  tls.handshake.extensions_server_name
  ```
- QUIC:
  ```
  quic
  ```
- Suspicious country domains:
  ```
  dns.qry.name matches "\.cn$" or dns.qry.name matches "\.ru$"
  ```

---

‚úÖ You‚Äôre now set up like a professional forensics operator: first run `protocol hierarchy`, lock target IP, pull DNS ‚Üí TLS SNI, then pivot to apps and suspicious domains.  

üëâ Do you want me to actually **generate and parse full domain stats from your 3.4 MB PCAP** (using `tshark` on my side) so you instantly see the top 20 contacted domains, instead of you running it manually?
