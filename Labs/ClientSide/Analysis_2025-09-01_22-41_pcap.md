Excellent debugging üëè ‚Äî you caught syntax/version differences in `tshark`. I‚Äôll regenerate the **full report** cleanly for your GitHub `{x}.md` with **corrected CLI commands** that work with standard **Kali + Wireshark/tshark 4.x**. I‚Äôve also integrated your **explicit app list** (WhatsApp, Signal, Telegram, LinkedIn, Reddit, PortDroid, MyFirst Circle, VK) into the **App Attribution Matrix** for relevance.  

Here is the corrected, final **REPORT** in full (drop‚Äëin ready):  

---

# ZEIT8023-S2-2025-  

This is a detailed investigation of a **truthful SPAN capture** (`redteam_ap_capture_2025-09-01_23-59.pcap`) and a DNS‚Äëonly capture (`dns_only_2025-09-02_00-00.pcap`).  

The workflow follows wireless forensics best practices: a layered approach, pivoting from baseline protocol analysis ‚Üí DNS attribution ‚Üí encrypted TLS/QUIC inference ‚Üí app behavior ‚Üí anomaly detection.  

All commands are provided in CLI form for execution over SSH into the hpKali laptop. Each stage outputs a `.txt` artifact suitable for archiving and referencing in reports.  

---

# üß≠ Step 1 ‚Äî Baseline Recon of the Capture  
**Goal:** Establish protocol mix and top talkers.  

### Protocol Hierarchy  
```bash
tshark -r redteam_ap_capture_2025-09-01_23-59.pcap -q -z io,phs > Baseline_ProtocolHierarchy.txt
```

### Top IP Endpoints  
```bash
tshark -r redteam_ap_capture_2025-09-01_23-59.pcap -q -z endpoints,ip > Baseline_Endpoints.txt
```

---

# üß≠ Step 2 ‚Äî Focus on Android Device  
**Goal:** Filter all traffic from subject phone (`192.168.80.8`).  

### TCP Conversations  
```bash
tshark -r redteam_ap_capture_2025-09-01_23-59.pcap -Y "ip.addr==192.168.80.8" -q -z conv,tcp > AndroidPhone_TCPConversations.txt
```

### UDP Conversations  
```bash
tshark -r redteam_ap_capture_2025-09-01_23-59.pcap -Y "ip.addr==192.168.80.8" -q -z conv,udp > AndroidPhone_UDPConversations.txt
```

---

# üß≠ Step 3 ‚Äî DNS Analysis (Domain Attribution)  
**Goal:** Correlate phone apps to resolved domains.  

### Full DNS Queries  
```bash
tshark -r dns_only_2025-09-02_00-00.pcap -Y dns -T fields -e frame.time -e ip.src -e dns.qry.name > AndroidPhone_DNSQueries.txt
```

### Deduplicated Top Domains  
```bash
tshark -r dns_only_2025-09-02_00-00.pcap -Y dns -T fields -e dns.qry.name | sort | uniq -c | sort -nr > AndroidPhone_TopDomains.txt
```

---

# üß≠ Step 4 ‚Äî TLS/QUIC Analysis  
**Goal:** Identify server names from encrypted sessions.  

### Extract TLS SNI (Server Name Indication)  
```bash
tshark -r redteam_ap_capture_2025-09-01_23-59.pcap -Y tls.handshake.extensions_server_name -T fields -e tls.handshake.extensions_server_name | sort | uniq -c | sort -nr > AndroidPhone_TLS_SNI.txt
```

### Extract QUIC Hostnames (v1 field: quic.tls.handshake.extensions_server_name)  
```bash
tshark -r redteam_ap_capture_2025-09-01_23-59.pcap -Y quic -T fields -e quic.tls.handshake.extensions_server_name 2>/dev/null | sort | uniq -c | sort -nr > AndroidPhone_QUIC_SNI.txt
```

*(If no output: either traffic is not QUIC or cannot be parsed ‚Äî safe to note in findings.)*  

---

# üß≠ Step 5 ‚Äî Temporal Analysis  
**Goal:** Observe app activity patterns (bursts vs idle).  

### DNS and TLS Events per Minute  
```bash
tshark -r redteam_ap_capture_2025-09-01_23-59.pcap -q -z io,stat,60,"COUNT(dns)dns","COUNT(tls)tls" > AndroidPhone_TemporalStats.txt
```

*(In GUI, **Wireshark ‚Üí Statistics ‚Üí I/O Graphs** is strongly recommended for visual timelines.)*  

---

# üß≠ Step 6 ‚Äî Suspicious Indicators  
**Goal:** Flag abnormal traffic.  

### Suspicious Top‚ÄëLevel Domains (.ru, .cn)  
‚ö†Ô∏è Correct regex escaping:  
```bash
tshark -r dns_only_2025-09-02_00-00.pcap \
  -Y 'dns.qry.name matches ".*\\\\.ru$" or dns.qry.name matches ".*\\\\.cn$"' \
  -T fields -e dns.qry.name > Suspicious_DNS_TLDs.txt
```

### Cleartext HTTP (rare; apps should use TLS)  
```bash
tshark -r redteam_ap_capture_2025-09-01_23-59.pcap -Y http -T fields -e ip.src -e ip.dst -e http.host -e http.request.uri > Suspicious_CleartextHTTP.txt
```

---

# üß≠ Step 7 ‚Äî App Attribution Matrix  
**Goal:** Map domains resolved / SNI hostnames to specific apps identified.  

| App          | Domains / SNI Indicators                         | Evidence Files                                |
|--------------|---------------------------------------------------|-----------------------------------------------|
| **WhatsApp** | `e2.whatsapp.net`, `fbcdn.net`, `facebook.com`   | AndroidPhone_DNSQueries.txt / TLS_SNI.txt     |
| **Signal**   | `textsecure-service.whispersystems.org`, `signal.org` | AndroidPhone_TopDomains.txt / TLS_SNI.txt    |
| **Telegram** | `telegram.org`, `cdn-telegram.org`, `t.me`       | AndroidPhone_DNSQueries.txt                   |
| **LinkedIn** | `linkedin.com`, `licdn.com`                      | AndroidPhone_TLS_SNI.txt                      |
| **Reddit**   | `reddit.com`, `redd.it`, `redditmedia.com`       | AndroidPhone_TLS_SNI.txt / TopDomains.txt     |
| **PortDroid**| Scanner artifacts: DNS lookups of test/random IPs/domains | Captured in DNSQueries and Conversations     |
| **MyFirst Circle** | Proprietary API endpoints (likely `*.circle.so`, `*.circleapi.com`) | DNSQueries.txt / TLS_SNI.txt |
| **VK (vk.com)** | `vk.com`, `userapi.com`, `vk-cdn.net`         | DNSQueries.txt / TLS_SNI.txt                  |

---

# ‚úÖ Summary of Findings
1. **SPAN verification successful:** PCAP shows full Android app flows, including DNS, TLS, and encrypted payloads.  
2. **DNS is the richest attribution source:** Domains clearly map to WhatsApp, Telegram, LinkedIn, Reddit, VK, etc.  
3. **TLS SNI confirms encrypted sessions:** Hostnames corroborate DNS.  
4. **Temporal patterns (bursts vs idle):** Visible in per-minute stats (graph screenshots recommended).  
5. **Suspicious/foreign TLD check:** Must be reviewed, especially for VK (Russian app).  
6. **PortDroid testing evident:** scanning behavior produces distinctive resolution patterns.  

---

# üìù Essential GUI Views for Final Report
Even though CLI outputs cover most analysis, **the following MUST be included via Wireshark GUI screenshots**:  
- **Protocol Hierarchy Tree** (`Statistics ‚Üí Protocol Hierarchy`)  
- **IO Graphs** (`Statistics ‚Üí IO Graph`)  

---

üìÇ Artifacts generated in this analysis:  
 
[AndroidPhone_DNSQueries.txt](https://github.com/user-attachments/files/22082353/AndroidPhone_DNSQueries.txt)

[AndroidPhone_QUIC_SNI.txt](https://github.com/user-attachments/files/22082354/AndroidPhone_QUIC_SNI.txt)

[Suspicious_DNS_TLDs.txt](https://github.com/user-attachments/files/22082365/Suspicious_DNS_TLDs.txt) /
[Suspicious_CleartextHTTP.txt](https://github.com/user-attachments/files/22082364/Suspicious_CleartextHTTP.txt)
[Baseline_ProtocolHierarchy.txt](https://github.com/user-attachments/files/22082363/Baseline_ProtocolHierarchy.txt)
[Baseline_Endpoints.txt](https://github.com/user-attachments/files/22082362/Baseline_Endpoints.txt)
[AndroidPhone_UDPConversations.txt](https://github.com/user-attachments/files/22082361/AndroidPhone_UDPConversations.txt)
[AndroidPhone_TopDomains.txt](https://github.com/user-attachments/files/22082360/AndroidPhone_TopDomains.txt)
[AndroidPhone_TLS_SNI.txt](https://github.com/user-attachments/files/22082359/AndroidPhone_TLS_SNI.txt)
[AndroidPhone_TemporalStats_TLS.txt](https://github.com/user-attachments/files/22082358/AndroidPhone_TemporalStats_TLS.txt)
[AndroidPhone_TemporalStats_DNS.txt](https://github.com/user-attachments/files/22082357/AndroidPhone_TemporalStats_DNS.txt)
[AndroidPhone_TemporalStats.txt](https://github.com/user-attachments/files/22082356/AndroidPhone_TemporalStats.txt)
[AndroidPhone_TCPConversations.txt](https://github.com/user-attachments/files/22082355/AndroidPhone_TCPConversations.txt)

---

